function Browser(){var e,t,n;return this.isIE=!1,this.isNS=!1,this.version=null,e=navigator.userAgent,t="MSIE",(n=e.indexOf(t))>=0?(this.isIE=!0,this.version=parseFloat(e.substr(n+t.length)),void 0):(t="Netscape6/",(n=e.indexOf(t))>=0?(this.isNS=!0,this.version=parseFloat(e.substr(n+t.length)),void 0):(t="Gecko",(n=e.indexOf(t))>=0?(this.isNS=!0,this.version=6.1,void 0):void 0))}function pageMousedown(e){var t;null!=activeButton&&(t=browser.isIE?window.event.srcElement:e.target.tagName?e.target:e.target.parentNode,t!=activeButton&&null==getContainerWith(t,"DIV","menu")&&(resetButton(activeButton),activeButton=null))}function buttonClick(e,t){var n;return n=browser.isIE?window.event.srcElement:e.currentTarget,n.blur(),null==n.menu&&(n.menu=document.getElementById(t),null==n.menu.isInitialized&&menuInit(n.menu)),null!=activeButton&&resetButton(activeButton),n!=activeButton?(depressButton(n),activeButton=n):activeButton=null,!1}function buttonMouseover(e,t){var n;n=browser.isIE?window.event.srcElement:e.currentTarget,null!=activeButton&&activeButton!=n&&buttonClick(e,t)}function depressButton(e){var t,n;e.className+=" menuButtonActive",t=getPageOffsetLeft(e),n=getPageOffsetTop(e)+e.offsetHeight,browser.isIE&&(t+=e.offsetParent.clientLeft,n+=e.offsetParent.clientTop),e.menu.style.left=t+"px",e.menu.style.top=n+"px",e.menu.style.visibility="visible"}function resetButton(e){removeClassName(e,"menuButtonActive"),null!=e.menu&&(closeSubMenu(e.menu),e.menu.style.visibility="hidden")}function menuMouseover(e){var t;t=browser.isIE?getContainerWith(window.event.srcElement,"DIV","menu"):e.currentTarget,null!=t.activeItem&&closeSubMenu(t)}function menuItemMouseover(e,t){var n,s,i,o;n=browser.isIE?getContainerWith(window.event.srcElement,"A","menuItem"):e.currentTarget,s=getContainerWith(n,"DIV","menu"),null!=s.activeItem&&closeSubMenu(s),s.activeItem=n,n.className+=" menuItemHighlight",null==n.subMenu&&(n.subMenu=document.getElementById(t),null==n.subMenu.isInitialized&&menuInit(n.subMenu)),i=getPageOffsetLeft(n)+n.offsetWidth,o=getPageOffsetTop(n);var u,l;browser.isNS&&(u=window.scrollX+window.innerWidth,l=window.scrollY+window.innerHeight),browser.isIE&&(u=(0!=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+(0!=document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth),l=(0!=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+(0!=document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight)),u-=n.subMenu.offsetWidth,l-=n.subMenu.offsetHeight,i>u&&(i=Math.max(0,i-n.offsetWidth-n.subMenu.offsetWidth+(s.offsetWidth-n.offsetWidth))),o=Math.max(0,Math.min(o,l)),n.subMenu.style.left=i+"px",n.subMenu.style.top=o+"px",n.subMenu.style.visibility="visible",browser.isIE?window.event.cancelBubble=!0:e.stopPropagation()}function closeSubMenu(e){null!=e&&null!=e.activeItem&&(null!=e.activeItem.subMenu&&(closeSubMenu(e.activeItem.subMenu),e.activeItem.subMenu.style.visibility="hidden",e.activeItem.subMenu=null),removeClassName(e.activeItem,"menuItemHighlight"),e.activeItem=null)}function menuInit(e){var t,n,s,i,o,u,l,r,a;if(browser.isIE)for(e.style.lineHeight="2.5ex",n=e.getElementsByTagName("SPAN"),r=0;r<n.length;r++)hasClassName(n[r],"menuItemArrow")&&(n[r].style.fontFamily="Webdings",n[r].firstChild.nodeValue="4");if(t=e.getElementsByTagName("A"),t.length>0){for(o=t[0].offsetWidth,r=0;r<t.length;r++){for(n=t[r].getElementsByTagName("SPAN"),s=null,i=null,a=0;a<n.length;a++)hasClassName(n[a],"menuItemText")&&(s=n[a]),hasClassName(n[a],"menuItemArrow")&&(i=n[a]);null!=s&&null!=i&&(s.style.paddingRight=o-(s.offsetWidth+i.offsetWidth)+"px")}browser.isIE&&(u=t[0].offsetWidth,t[0].style.width=u+"px",l=t[0].offsetWidth-u,u-=l,t[0].style.width=u+"px"),e.isInitialized=!0}}function getContainerWith(e,t,n){for(;null!=e;){if(null!=e.tagName&&e.tagName==t&&hasClassName(e,n))return e;e=e.parentNode}return e}function hasClassName(e,t){var n,s;for(s=e.className.split(" "),n=0;n<s.length;n++)if(s[n]==t)return!0;return!1}function removeClassName(e,t){var n,s,i;if(null!=e.className){for(i=new Array,s=e.className.split(" "),n=0;n<s.length;n++)s[n]!=t&&i.push(s[n]);e.className=i.join(" ")}}function getPageOffsetLeft(e){var t;return t=e.offsetLeft,null!=e.offsetParent&&(t+=getPageOffsetLeft(e.offsetParent)),t}function getPageOffsetTop(e){var t;return t=e.offsetTop,null!=e.offsetParent&&(t+=getPageOffsetTop(e.offsetParent)),t}var browser=new Browser,activeButton=null;browser.isIE?document.onmousedown=pageMousedown:document.addEventListener("mousedown",pageMousedown,!0);